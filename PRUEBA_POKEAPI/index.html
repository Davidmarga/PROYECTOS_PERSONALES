<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Movimientos Pokemon</title>
    <link rel="stylesheet" type="text/css" href="estilo.css">
</head>
<body>
<h1>Elige un pokemon</h1>
<select id="selectorPokemon">
    <option disabled selected>...Cargando Pokemon...</option>
</select>
    <h2 id="titulo"></h2>
    <div id="contenedor">
        <img id="foto"/>
        <ul id="movimientos"></ul>
    </div>

<script>
    const selector = document.getElementById('selectorPokemon');
   fetch('https://pokeapi.co/api/v2/pokemon?limit=1302')
   .then(res=> res.json())
   .then(data =>{
    selector.innerHTML = '<option disabled selected>-- Selecciona un Pok√©mon --</option>';
    data.results.forEach(pokemon=>{
        const option = document.createElement('option');
        option.value=pokemon.name;
        option.textContent = pokemon.name
        selector.appendChild(option);
    });
   });

   selector.addEventListener('change',()=>{
    const nombrePokemon = selector.value;
    const titulo = document.getElementById('titulo');
    titulo.textContent= `movimientos de ${nombrePokemon}`;
  
    

  fetch(`https://pokeapi.co/api/v2/pokemon/${nombrePokemon}`)
            .then(res => res.json())
            .then(data => {
                const lista = document.getElementById('movimientos');
                lista.innerHTML = "";

                const foto = document.getElementById("foto");
                        foto.src=data.sprites.other['official-artwork'].front_default;
                        foto.alt = `Imagen de ${nombrePokemon}`;

                // data.moves es un array, cada elemento tiene la forma:
                // { move: { name: 'mega-punch', url: '...' }, version_group_details: [...] }
                data.moves.forEach(movimiento => {
                    // Creamos un <li> para cada movimiento
                    const li = document.createElement('li');
                    // Sacamos el nombre del movimiento
                    const nombreMovimiento = document.createElement('strong');
                    nombreMovimiento.textContent=movimiento.move.name;
                    nombreMovimiento.style.cursor = "pointer";
                    
                    

                    //crear sublista para metodo y nivel
                    const detalles=document.createElement('ul');
                    detalles.classList.add('oculto');

                    movimiento.version_group_details.forEach(detalle => {
                        const metodo = detalle.move_learn_method.name
                        const nivel = detalle.level_learned_at;
                        const juego = detalle.version_group.name;

                        const juegostr=document.createElement('strong');
                        juegostr.textContent=juego;

                        const metodoli = document.createElement ('li');
                        metodoli.textContent="Metodo de aprendizaje:" + " " + metodo + " " + "Nivel de aprendizaje:" +" " + nivel;
                        detalles.appendChild(juegostr);
                        detalles.appendChild(metodoli);
                       
                    });

                        nombreMovimiento.addEventListener('click',()=>{
                            detalles.classList.toggle('oculto');
                        });
                        li.appendChild(nombreMovimiento);
                        li.appendChild(detalles);
                        lista.appendChild(li);

                });
              
            })
            .catch(error => {
                console.error('Error al obtener los datos:', error);
            });
   })


</script>

</body>
</html>